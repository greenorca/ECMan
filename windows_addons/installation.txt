
# Tune clean Win10-Installation (regular client)

## Remove crap apps

Get-AppxPackage *OneNote* | Remove-AppxPackage
Get-AppxPackage *xbox* | Remove-AppxPackage
Get-AppxPackage *3d* | Remove-AppxPackage
Get-AppxPackage *bing* | Remove-AppxPackage
Get-AppxPackage *people | Remove-AppxPackage
Get-AppxPackage *wallet | Remove-AppxPackage
Get-AppxPackage *sykpe* | Remove-AppxPackage

* %SystemRoot%\SysWOW64\OneDriveSetup.exe /uninstall

## stop and disable services

* Set-Service -Name wuauserv -StartupType Disabled
* Get-Service -Name wuauserv | Stop-Service
* Set-Service -Name wsearch -StartupType Disabled
* Get-Service -Name wsearch | Stop-Service

# Powershell - Monitoring

* free Memory (in GB)
```
$os=Get-CimInstance Win32_OperatingSystem
write-host ([math]::Round($os.FreePhysicalMemory/(1024*1024),2)) "GB free Memory" 
write-host ([math]::Round($os.TotalVisibleMemorySize/(1024*1024),2)) "GB total Memory" 
```

* free disk space
```
$disk = Get-WMIObject Win32_Logicaldisk -filter "deviceid='$($os.systemdrive)'"
$disk.FreeSpace / (1024*1024*1024)

//or even:
write-host ([math]::Round($disk.FreeSpace / (1024*1024*1024),2)) "GB free on C:\"
```

* Powershell UNIX top

```
While(1) {ps | sort -des cpu | select -f 15 | ft -a; sleep 1; cls}
```

# Create distrib package:

1. install VisualStudio 2015 C++ Redistrib-Pack
1. install Python (python-3.6.8-webinstall)
1. pip install PySide2==5.11.2, PyWinRm, 

## Using PyInstaller

```
pip install PyInstaller  (used ==3.3 for install problems with latest pip)

pyinstaller --distpath C:\Users\Sven\Desktop\ --workpath C:\Users\Sven\tmp\ -i green_orca.ico --add-data ./scripts;./scripts ECMan.py


```

see [http://www.pyinstaller.org/](http://www.pyinstaller.org/)

## Using cx_Freeze

see https://cx-freeze.readthedocs.io/en/latest/overview.html